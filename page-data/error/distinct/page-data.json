{"componentChunkName":"component---src-templates-blog-post-js","path":"/error/distinct/","result":{"data":{"site":{"siteMetadata":{"title":"hong_devlog","author":"hongdev","siteUrl":"https://hong-dev.github.io","comment":{"disqusShortName":"","utterances":"hong-dev/hong-dev.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"74a8fc63-8f2f-58ce-b538-5e013099af1c","excerpt":"Situation Django ORMìœ¼ë¡œ, Userë³„ë¡œ ê°€ì¥ ìµœê·¼ ê²°ì œí•œ ì£¼ë¬¸ ê±´ì„ return í•˜ê³ ì í•˜ì˜€ë‹¤. ê·¸ë˜ì„œ ê²°ì œì¼ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•œ í›„, userë¥¼ ê¸°ì¤€ìœ¼ë¡œ distinct í•˜ê³ ì í•˜ì˜€ë‹¤. distinct() ì¤‘ë³µê°’ì„ ì œê±°í•˜ê³  ì¤‘ë³µê°’ë“¤ì€ í•˜ë‚˜ë§Œ ë‚¨ê²¨ì„œ return í•œë‹¤. ê²°ê³¼ëŠ”, NotSupportedError ë°œìƒ Cause MySQLì—ì„œëŠ”  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. PostgresSQLì—ì„œë§Œ í•´ë‹¹ ì½”ë“œê°€ ì‘ë™í•œë‹¤ê³  í•œë‹¤. MySQLâ€¦","html":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">django.db.utils.NotSupportedError: DISTINCT ON fields is not supported by this database backend</code></pre></div>\n<br>\n<h2 id=\"situation\" style=\"position:relative;\"><a href=\"#situation\" aria-label=\"situation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Situation</h2>\n<p>Django ORMìœ¼ë¡œ, Userë³„ë¡œ ê°€ì¥ ìµœê·¼ ê²°ì œí•œ ì£¼ë¬¸ ê±´ì„ return í•˜ê³ ì í•˜ì˜€ë‹¤.<br>\nê·¸ë˜ì„œ ê²°ì œì¼ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•œ í›„, userë¥¼ ê¸°ì¤€ìœ¼ë¡œ distinct í•˜ê³ ì í•˜ì˜€ë‹¤.</p>\n<blockquote>\n<h2 id=\"distinct\" style=\"position:relative;\"><a href=\"#distinct\" aria-label=\"distinct permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><em>distinct()</em></h2>\n<p>ì¤‘ë³µê°’ì„ ì œê±°í•˜ê³  ì¤‘ë³µê°’ë“¤ì€ í•˜ë‚˜ë§Œ ë‚¨ê²¨ì„œ return í•œë‹¤.</p>\n</blockquote>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">order_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    Order\n    <span class=\"token punctuation\">.</span>objects\n    <span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span><span class=\"token string\">'-payment_date'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>distinct<span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ê²°ê³¼ëŠ”, NotSupportedError ë°œìƒ</p>\n<br>\n<h2 id=\"cause\" style=\"position:relative;\"><a href=\"#cause\" aria-label=\"cause permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cause</h2>\n<p>MySQLì—ì„œëŠ” <code class=\"language-text\">.distinct({field_name})</code> ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.<br>\nPostgresSQLì—ì„œë§Œ í•´ë‹¹ ì½”ë“œê°€ ì‘ë™í•œë‹¤ê³  í•œë‹¤.<br>\nMySQLì—ì„œëŠ” <code class=\"language-text\">.distinct()</code>ì˜ í˜•íƒœë¡œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , íŠ¹ì • fieldë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µê°’ì„ ì œê±°í•  ìˆ˜ëŠ” ì—†ë‹¤.</p>\n<br>\n<h2 id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solution</h2>\n<p>Order tableì„ ê¸°ì¤€ìœ¼ë¡œ userì˜ ì¤‘ë³µê°’ì„ ì—†ì• ë ¤ê³  í•˜ì§€ë§ê³ , User tableì„ ê¸°ì¤€ìœ¼ë¡œ ì¡ìœ¼ë©´ user ì¤‘ë³µì„ ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.<br>\nê·¸ëŸ¬ë‚˜ ê°€ì¥ ìµœì‹ ì˜ payment dateë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë½‘ì•„ë‚´ì•¼ í•˜ë¯€ë¡œ, user tableì—ì„œëŠ” ê·¸ ì‘ì—…ì„ í•  ìˆ˜ê°€ ì—†ê³  order tableì—ì„œ <code class=\"language-text\">.latest('payment_date')</code>ë¥¼ í•´ì•¼í–ˆë‹¤.<br>\nê·¸ë˜ì„œ order tableì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ë˜ ëª¨ë“  userë¥¼ forë¬¸ìœ¼ë¡œ ëŒë ¤ì„œ í•˜ë‚˜ì”© ê°€ì¥ ìµœì‹  ì£¼ë¬¸ì„ ì°¾ì•˜ë‹¤.<br>\n<code class=\"language-text\">distinct</code> í•˜ë‚˜ë©´ í•´ê²°ë˜ì—ˆì„ ê²ƒì„ ì´ë ‡ê²Œë‚˜ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ querying í•´ì•¼í•˜ë‚˜ ì‹¶ì€ë°..ğŸ˜­</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">order_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    Order\n    <span class=\"token punctuation\">.</span>objects\n    <span class=\"token punctuation\">.</span>select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\nusers <span class=\"token operator\">=</span> User<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\norders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"id\"</span>           <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"user_id\"</span>      <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"user_name\"</span>    <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"user_email\"</span>   <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"order_number\"</span> <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>order_number<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"product\"</span>      <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"payment_date\"</span> <span class=\"token punctuation\">:</span> order<span class=\"token punctuation\">.</span>payment_date\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> user <span class=\"token keyword\">in</span> users <span class=\"token keyword\">if</span>\n    <span class=\"token punctuation\">(</span>order <span class=\"token punctuation\">:</span><span class=\"token operator\">=</span> order_list<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span>user <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>latest<span class=\"token punctuation\">(</span><span class=\"token string\">'payment_date'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<br>\n<br>\n<blockquote>\n<p>Reference: <a href=\"https://stackoverflow.com/questions/54249017/distinct-on-fields-is-not-supported-by-this-database-backend\">DISTINCT ON fields is not supported by this database backend</a></p>\n</blockquote>","frontmatter":{"title":"NotSupportedError: DISTINCT","date":"May 15, 2020","category":"error","thumbnail":null}}},"pageContext":{"slug":"/error/distinct/","previous":{"fields":{"slug":"/algorithm/replace/"},"frontmatter":{"title":"ê´„í˜¸ì˜ ë°°ì—´ì—ì„œ ì‡ ë§‰ëŒ€ê¸° ê°œìˆ˜ ì°¾ê¸°","category":"algorithm","draft":false}},"next":{"fields":{"slug":"/algorithm/truck/"},"frontmatter":{"title":"íŠ¸ëŸ­ë“¤ì´ ëª¨ë‘ ë‹¤ë¦¬ë¥¼ í†µê³¼í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„","category":"algorithm","draft":false}}}},"staticQueryHashes":["2353110810","3128451518"]}
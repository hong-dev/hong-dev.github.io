{"componentChunkName":"component---src-templates-blog-post-js","path":"/android/thread-handler-looper/","result":{"data":{"site":{"siteMetadata":{"title":"hong_devlog","author":"hongdev","siteUrl":"https://hong-dev.github.io","comment":{"disqusShortName":"","utterances":"hong-dev/hong-dev.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"3f315072-aaa6-5006-868f-45e2069dd444","excerpt":"Background threads ëª¨ë“  ì•ˆë“œë¡œì´ë“œ ì•±ì€ main threadë¥¼ ì‚¬ìš©í•˜ì—¬ UI operationsë¥¼ ì²˜ë¦¬í•œë‹¤. ì´ main threadì—ì„œ long-running operationsë¥¼ í˜¸ì¶œí•˜ë©´ ì•±ì´ ì •ì§€í•˜ê±°ë‚˜ ì‘ë‹µí•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. ë§Œì•½ network requestë¥¼ main threadì—ì„œ ì²˜ë¦¬í•œë‹¤ë©´, network responseë¥¼ ë°›ì„ ë•Œê¹Œì§€ UIê°€ ë©ˆì¶˜ë‹¤. Background threadsë¥¼ ìƒì„±í•˜ì—¬ ì´ëŸ¬í•œ long-running operationsë¥¼ ì²˜ë¦¬í•œë‹¤ë©´, mainâ€¦","html":"<h1 id=\"background-threads\" style=\"position:relative;\"><a href=\"#background-threads\" aria-label=\"background threads permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Background threads</h1>\n<ul>\n<li>ëª¨ë“  ì•ˆë“œë¡œì´ë“œ ì•±ì€ main threadë¥¼ ì‚¬ìš©í•˜ì—¬ UI operationsë¥¼ ì²˜ë¦¬í•œë‹¤.</li>\n<li>\n<p>ì´ main threadì—ì„œ long-running operationsë¥¼ í˜¸ì¶œí•˜ë©´ ì•±ì´ ì •ì§€í•˜ê±°ë‚˜ ì‘ë‹µí•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</p>\n<p>ë§Œì•½ network requestë¥¼ main threadì—ì„œ ì²˜ë¦¬í•œë‹¤ë©´, network responseë¥¼ ë°›ì„ ë•Œê¹Œì§€ UIê°€ ë©ˆì¶˜ë‹¤.</p>\n</li>\n<li><strong>Background threads</strong>ë¥¼ ìƒì„±í•˜ì—¬ ì´ëŸ¬í•œ long-running operationsë¥¼ ì²˜ë¦¬í•œë‹¤ë©´, main threadëŠ” ê·¸ë™ì•ˆ UI updatesë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<br>\n<h1 id=\"thread-pool\" style=\"position:relative;\"><a href=\"#thread-pool\" aria-label=\"thread pool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thread pool</h1>\n<ul>\n<li>Thread poolì€ queueì—ì„œ ë³‘ë ¬ë¡œ ì‘ì—…ì„ ì‹¤í–‰í•˜ê¸°ìœ„í•´ ê´€ë¦¬ë˜ëŠ” threadsì˜ ì§‘í•©ì´ë‹¤.</li>\n<li>Thread poolì— taskë¥¼ ë³´ë‚´ê¸° ìœ„í•´ì„œ, <code class=\"language-text\">ExecutorService</code> interfaceê°€ ì‚¬ìš©ëœë‹¤.<br>\n(<code class=\"language-text\">ExecutorService</code>ëŠ” android application componentì˜ Serviceì™€ëŠ” ì•„ë¬´ ê´€ë ¨ì´ ì—†ë‹¤.)</li>\n<li>\n<p>Threadsë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì€ expensive í•˜ë¯€ë¡œ, thread poolì€ appì´ initializeë  ë•Œ ë”± í•œ ë²ˆë§Œ ìƒì„±í•´ì•¼ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// background tasksì—ì„œ ì‚¬ìš©í•  threads 4ê°œì˜ thread pool ìƒì„±</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApplication</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Application</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ExecutorService</span> executorService <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<h2 id=\"\" style=\"position:relative;\"><a href=\"#\" aria-label=\" permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ’¡</h2>\n<ul>\n<li>ì•±ì˜ ëª¨ë“  threadëŠ” main thread í¬í•¨í•˜ì—¬ ë‹¤ë¥¸ threadsì™€ ë³‘ë ¬ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, codeê°€ <strong>thread-safe</strong> í•œì§€ í™•ì¸í•´ì•¼ í•œë‹¤.<br>\nThreads ê°„ì— ê³µìœ ë˜ëŠ” variablesì— write í•˜ëŠ” ê²ƒì„ í”¼í•˜ê³ , immutable dataë¥¼ ì „ë‹¬í•œë‹¤.</li>\n<li>Threads ê°„ì— stateë¥¼ ê³µìœ í•´ì•¼ í•˜ëŠ” ê²½ìš°, <strong>lock</strong>ê³¼ ê°™ì€ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ì—¬ access ê´€ë¦¬ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.<br>\nì¼ë°˜ì ìœ¼ë¡œ, ê°€ëŠ¥í•˜ë©´ threads ê°„ì— mutable stateë¥¼ ê³µìœ í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.</li>\n</ul>\n<br>\n<h1 id=\"handler\" style=\"position:relative;\"><a href=\"#handler\" aria-label=\"handler permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Handler</h1>\n<ul>\n<li>Handlerë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ threadì—ì„œ ìˆ˜í–‰í•  ì‘ì—…ì„ queueì— ë„£ì„ ìˆ˜ ìˆë‹¤.</li>\n<li>ê° Handler instanceëŠ” single thread ë° í•´ë‹¹ threadì˜ message queueì™€ ì—°ê²°ëœë‹¤.</li>\n<li>ìƒˆë¡œìš´ Handlerë¥¼ ìƒì„±í•˜ë©´, <code class=\"language-text\">Looper</code>ì— ë°”ì¸ë”© ëœë‹¤.</li>\n<li>ì¦‰, HandlerëŠ” ë¯¸ë˜ì˜ ì–´ë–¤ ì‹œì ì—ì„œ ì‹¤í–‰ë  messagesì™€ runnablesë¥¼ schedule í•˜ê³ , ë‹¤ë¥¸ threadì—ì„œ ìˆ˜í–‰í•  ì‘ì—…ì„ queueì— ì¶”ê°€í•œë‹¤.</li>\n</ul>\n<br>\n<h1 id=\"looper\" style=\"position:relative;\"><a href=\"#looper\" aria-label=\"looper permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Looper</h1>\n<ul>\n<li>Threadì— ëŒ€í•œ message loopë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” class</li>\n<li>ê¸°ë³¸ì ìœ¼ë¡œ threadì—ëŠ” ì—°ê²°ëœ message loopê°€ ì—†ë‹¤.<br>\nìƒì„±í•˜ë ¤ë©´ loopë¥¼ ì‹¤í–‰í•  threadì—ì„œ <code class=\"language-text\">prepare()</code>ë¥¼ í˜¸ì¶œí•œ ë‹¤ìŒ, loopê°€ stop í•  ë•Œê¹Œì§€ messageë¥¼ ì²˜ë¦¬í•˜ë„ë¡ <code class=\"language-text\">loop()</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>\n<li>Message loopì™€ì˜ ëŒ€ë¶€ë¶„ì˜ interactionì€ <code class=\"language-text\">Handler</code> classë¥¼ í†µí•´ ì´ë£¨ì–´ì§„ë‹¤.</li>\n<li>\n<p>Looperì—ëŠ” main threadì˜ Looperë¥¼ ê²€ìƒ‰í•˜ëŠ” <code class=\"language-text\">getMainLooper()</code> helper functionì´ ìˆë‹¤.<br>\nì´ Looperë¥¼ ì‚¬ìš©í•˜ì—¬ Handlerë¥¼ ìƒì„±í•¨ìœ¼ë¡œì¨, main threadì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.<br>\nê½¤ ìì£¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìœ„ì—ì„œ ì„ ì–¸í•œ <code class=\"language-text\">ExecutorService</code>ì™€ ë™ì¼í•œ ìœ„ì¹˜ì— Handlerì˜ instanceë¥¼ ì €ì¥í•  ìˆ˜ë„ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApplication</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Application</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ExecutorService</span> executorService <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Handler</span> mainThreadHandler <span class=\"token operator\">=</span> <span class=\"token class-name\">HandlerCompat</span><span class=\"token punctuation\">.</span><span class=\"token function\">createAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Looper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getMainLooper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<br>\n<h1 id=\"how-does-it-work\" style=\"position:relative;\"><a href=\"#how-does-it-work\" aria-label=\"how does it work permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How does it work</h1>\n<ul>\n<li>ìˆ˜í–‰ë˜ì–´ì•¼ í•  ì—¬ëŸ¬ ê°œì˜ tasksë“¤ì´ ë“¤ì–´ìˆëŠ” <code class=\"language-text\">MessageQueue</code>ê°€ ìˆë‹¤.</li>\n<li><code class=\"language-text\">Handler</code>ëŠ” backgroundë¡œ ìˆ˜í–‰ë˜ì–´ì•¼ í•  taskë¥¼ UI threadsì—ì„œ ë¶„ë¦¬í•´ì„œ  <code class=\"language-text\">MessageQueue</code>ì— ë„£ëŠ”ë‹¤.<br>\nì´ ë•Œ, ë‹¨ìˆœíˆ ì²˜ìŒì´ë‚˜ ëì— ë„£ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì–¸ì œ ì‹¤í–‰í•  ê²ƒì¸ì§€ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</li>\n<li><code class=\"language-text\">Looper</code>ëŠ” ì´ <code class=\"language-text\">MessageQueue</code>ë¥¼ ê³„ì† ë°˜ë³µí•´ì„œ ëŒë©´ì„œ, í˜„ì¬ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” messageë¥¼ ì°¾ëŠ”ë‹¤.</li>\n<li><code class=\"language-text\">Looper</code>ê°€ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” messageë¥¼ <code class=\"language-text\">Handler</code>ì—ê²Œ ë³´ë‚´ë©´, <code class=\"language-text\">Handler</code>ëŠ” ê·¸ ì‘ì—…ì„ ì²˜ë¦¬í•œë‹¤.</li>\n</ul>\n<br>\n<br>\n<br>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><em>Reference</em></h3>\n<blockquote>\n<p><em><a href=\"https://developer.android.com/guide/background/threading\">Running Android tasks in background threads</a><br>\n<a href=\"https://developer.android.com/reference/android/os/Handler\">Handler</a><br>\n<a href=\"https://developer.android.com/reference/android/os/Looper\">Looper</a></em></p>\n</blockquote>","frontmatter":{"title":"Android Thread, Handler, Looper","date":"February 13, 2022","category":"android","thumbnail":null}}},"pageContext":{"slug":"/android/thread-handler-looper/","previous":{"fields":{"slug":"/java/enum/"},"frontmatter":{"title":"Enum in Java","category":"java","draft":false}},"next":{"fields":{"slug":"/java/serializable-parcelable/"},"frontmatter":{"title":"Serializable vs Parcelable","category":"java","draft":false}}}},"staticQueryHashes":["2353110810","3128451518"]}
{"componentChunkName":"component---src-templates-blog-post-js","path":"/study/join/","result":{"data":{"site":{"siteMetadata":{"title":"hong_devlog","author":"hongdev","siteUrl":"https://hong-dev.github.io","comment":{"disqusShortName":"","utterances":"hong-dev/hong-dev.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"11965c7c-fc60-518f-bd9a-d295567f1104","excerpt":"Table 간에 foreign key로 참조 관계를 만들었으면 data를 뽑아낼 때 그 관계를 활용해야겠지. 정보를 가져올 때 주로 쓰인다. Join 원하는 테이블을 조건을 통해서 합친다. Query의 효율성을 위해서 생겼다. 원래는 select를 2-3번씩 하면서 query가 도는데, join은 그걸 한번에 할 수 있다. join은 참조되는 테이블끼리 하는 거고, 연관관계가 없으면 join…","html":"<ul>\n<li>Table 간에 foreign key로 참조 관계를 만들었으면 data를 뽑아낼 때 그 관계를 활용해야겠지.</li>\n<li>정보를 가져올 때 주로 쓰인다.</li>\n</ul>\n<h3 id=\"join\" style=\"position:relative;\"><a href=\"#join\" aria-label=\"join permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Join</h3>\n<ul>\n<li>원하는 테이블을 조건을 통해서 합친다.</li>\n<li>Query의 효율성을 위해서 생겼다.<br>\n원래는 select를 2-3번씩 하면서 query가 도는데, join은 그걸 한번에 할 수 있다.</li>\n<li>join은 참조되는 테이블끼리 하는 거고, 연관관계가 없으면 join은 불가능하다.<br>\n연관관계 없는 것들끼리의 조인은 다른 방법이 있다.</li>\n<li><strong>주의할 점!</strong> : 주체가 누구인지를 잘 알아야해! 뭐가 중심인지를 명확히 해야해!</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#data를 가져올 때 아래의 방식은 효율성이 매우 떨어진다.</span>\n\ndrink1 <span class=\"token operator\">=</span> Product.objects.get<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">#&lt;Product: Product object (1)></span>\n\nSubCategory.objects.filter<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span>drink1.category_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.name</code></pre></div>\n<h2 id=\"방법-1\" style=\"position:relative;\"><a href=\"#%EB%B0%A9%EB%B2%95-1\" aria-label=\"방법 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>방법 1</h2>\n<ol>\n<li>정참조일 때: 그냥 가져오면 된다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">drink <span class=\"token operator\">=</span> Product.objects.get<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ndrink.sub_category.name    <span class=\"token comment\">#drink1의 sub_category라는 field의 name</span></code></pre></div>\n<ol start=\"2\">\n<li>역참조일 때: <code class=\"language-text\">_set</code>으로 가져온다.</li>\n<li>_set 전에 기재되는 이름은 class명을 모두 소문자로 바꾼 것이다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">category <span class=\"token operator\">=</span> SubCategory.objects.get<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ncategory.product_set.all<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n<span class=\"token comment\"># 카테고리1번을 보고 있는 역참조 관계에 있는 product들이 반환된다.(쿼리셋 형태)</span></code></pre></div>\n<h2 id=\"방법-2\" style=\"position:relative;\"><a href=\"#%EB%B0%A9%EB%B2%95-2\" aria-label=\"방법 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>방법 2</h2>\n<ul>\n<li>방법 1의 문제점이 있다. 참조하는 테이블과 참조 받는 테이블을 차례대로 불러와야 하므로 쿼리가 그만큼 돌아간다.</li>\n<li><code class=\"language-text\">related</code> 방식으로 사용하면 우리 눈에는 보이지 않지만, 연결되는 각각의 테이블을 한번에 소환하기 때문에 효율이 높아진다.</li>\n</ul>\n<h3 id=\"one-to-one\" style=\"position:relative;\"><a href=\"#one-to-one\" aria-label=\"one to one permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>One to One</h3>\n<ul>\n<li><code class=\"language-text\">select_related</code></li>\n<li>정참조. 좌변에서 우변을 본다</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">drink <span class=\"token operator\">=</span> Product.objects.select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'sub_category'</span><span class=\"token punctuation\">)</span>.get<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\ndrink.sub_category.name\n\n\nSubCategory.objects.select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'main_category'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>.main_category.name</code></pre></div>\n<h3 id=\"one-to-many--many-to-many\" style=\"position:relative;\"><a href=\"#one-to-many--many-to-many\" aria-label=\"one to many  many to many permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>One to Many / Many to Many</h3>\n<ul>\n<li><code class=\"language-text\">prefetch_related</code></li>\n<li>역참조</li>\n<li>prefetch를 쓰면 역참조이기 때문에 querying을 한번 더 할 수밖에 없다.</li>\n<li>drink3은 객체로 나왔는데, set을 붙여서 다시 쿼리셋으로 만들어준다.????</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">drink3 <span class=\"token operator\">=</span> SubCategory.objects.filter<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>.prefetch_related<span class=\"token punctuation\">(</span><span class=\"token string\">\"product_set\"</span><span class=\"token punctuation\">)</span>\n\ndrink3     <span class=\"token comment\">## 쿼리셋 형태: &lt;QuerySet [&lt;SubCategory: SubCategory object (1)>]></span>\ndrink3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\">## 객체 형태 : &lt;SubCategory: SubCategory object (1)></span>\n\n\ndrink3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.name\ndrink3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.product_set.values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\ndrink3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.product_set.get<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>.name  <span class=\"token comment\">## 객체 형태</span>\ndrink3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.product_set.filter<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">## 쿼리셋 형태</span></code></pre></div>\n<h3 id=\"select_related를-사용하는-이유\" style=\"position:relative;\"><a href=\"#select_related%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"select_related를 사용하는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>select_related를 사용하는 이유</h3>\n<ul>\n<li>select_related 해버리면 아예 Join이 되어서 입력되기 때문에, 연결 테이블의 data를 찾을 때 또 쿼리가 돌지 않아도 된다.</li>\n<li>select_related의 join 관계는 cache에 저장되고, 창을 닫으면 사라진다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> a <span class=\"token operator\">=</span> Product.objects.all<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> print<span class=\"token punctuation\">(</span>a.query<span class=\"token punctuation\">)</span>\nSELECT <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>description<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>image<span class=\"token variable\">`</span></span> FROM <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span>\n\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b <span class=\"token operator\">=</span> Product.objects.select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'sub_category'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> print<span class=\"token punctuation\">(</span>b.query<span class=\"token punctuation\">)</span>\nSELECT <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>description<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>image<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span> FROM <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span> LEFT OUTER JOIN <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span> ON <span class=\"token punctuation\">(</span><span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span> <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> c <span class=\"token operator\">=</span> Product.objects.select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'sub_category'</span>, <span class=\"token string\">'main_category'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> print<span class=\"token punctuation\">(</span>c.query<span class=\"token punctuation\">)</span>\nSELECT <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>description<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>image<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span> FROM <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span> LEFT OUTER JOIN <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span> ON <span class=\"token punctuation\">(</span><span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span> <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">)</span> LEFT OUTER JOIN <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span> ON <span class=\"token punctuation\">(</span><span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span> <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">`</span>subcategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> d <span class=\"token operator\">=</span> Product.objects.select_related<span class=\"token punctuation\">(</span><span class=\"token string\">'main_category'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> print<span class=\"token punctuation\">(</span>d.query<span class=\"token punctuation\">)</span>\nSELECT <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>sub_category_id<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>description<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>image<span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span>, <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>name<span class=\"token variable\">`</span></span> FROM <span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span> LEFT OUTER JOIN <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span> ON <span class=\"token punctuation\">(</span><span class=\"token variable\"><span class=\"token variable\">`</span>products<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span>main_category_id<span class=\"token variable\">`</span></span> <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">`</span>maincategories<span class=\"token variable\">`</span></span><span class=\"token builtin class-name\">.</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">id</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"queryset--object\" style=\"position:relative;\"><a href=\"#queryset--object\" aria-label=\"queryset  object permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>**Queryset / Object</h3>\n<ul>\n<li>Queryset : 메소드를 활용하여 추가 작업을 할 수 있다.</li>\n<li>Object : 그냥 데이터로 딱 빠져나온 것이므로, 추가 작업을 할 수가 없다. 쿼리가 아니기 때문에 filter 같은 메소드를 못 쓴다. select_related, .query도 모두 쿼리셋일 때 가능하다.</li>\n</ul>\n<h2 id=\"방법-3\" style=\"position:relative;\"><a href=\"#%EB%B0%A9%EB%B2%95-3\" aria-label=\"방법 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>방법 3</h2>\n<ul>\n<li><code class=\"language-text\">__</code> 로 가져오는 방법</li>\n<li>연결만 되어 있다면, 역참조든 정참조든 다 가능하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> SubCategory.objects.filter<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>.values<span class=\"token punctuation\">(</span><span class=\"token string\">'main_category__name'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>QuerySet <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">'main_category__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'음료'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> SubCategory.objects.filter<span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>.values<span class=\"token punctuation\">(</span><span class=\"token string\">'product__name'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>QuerySet <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'나이트로 바닐라 크림'</span><span class=\"token punctuation\">}</span>, <span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'쇼콜라 클라우드'</span><span class=\"token punctuation\">}</span>, <span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'돌체 콜드 브루'</span><span class=\"token punctuation\">}</span>, <span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'레이즌 스콘'</span><span class=\"token punctuation\">}</span>, <span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'녹차 머핀'</span><span class=\"token punctuation\">}</span>, <span class=\"token punctuation\">{</span><span class=\"token string\">'product__name'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'치즈 베이글'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></code></pre></div>","frontmatter":{"title":"[Django] Table 연결 (ORM의 Join 기능)","date":"February 21, 2020","category":"django","thumbnail":null}}},"pageContext":{"slug":"/study/join/","previous":{"fields":{"slug":"/study/codekata_6/"},"frontmatter":{"title":"[CodeKata] 6","category":"algorithm","draft":false}},"next":{"fields":{"slug":"/study/codekata_7/"},"frontmatter":{"title":"[CodeKata] 7","category":"algorithm","draft":false}}}},"staticQueryHashes":["2353110810","3128451518"]}